# Classification of 12-lead ECGs from the PTB-XL Database by Yap Jun Hong (Nemo)

## Section 1: Why is this project important?

### Part 1.1: What is an ECG?

ECG is short for an "**E**lectro**c**ardio**g**ram", a tool frequently used by doctors to measure the strength and flow of electrical currents in the heart. Abnormalities in these electrical signals correspond to disease symptoms that doctors can recognise and address. The most common type of ECG used is a '12-lead ECG', which can be thought of as viewing the electrical signal flow in the heart from 12 different angles or viewpoints. The 12-lead ECG is measured by sticking electrodes on the limbs, for a vertical view, and on the chest, for a horizontal view. The 12-lead ECG gives information such as:

- Strength of the generated electrical signal
- Direction of the flow of the electrical signal through the heart

A reading from a healthy patient is called 'Sinus Rhythm'.

### Part 1.2: How can machine learning help doctors with reading ECG data?

Manually interpreting an ECG requires years of training on the job and in medical school. Manual interpretation is also time-consuming; doctors may make mistakes over the course of a day as they tire out. Using machine learning methods to automatically interpret ECG data can help increase the chances of noticing mistakes. In emergency situations, automatic interpretation can also be used in areas and emergencies without sufficiently skilled doctors. However, the overall goal of automatic interpretation is to assist doctors in coming to conclusions about abnormalities in the ECG.

## Section 2: Datasets used

### Part 2.1: Dataset sources

This project uses the PTB-XL database to do classification. The dataset can be found both on [physionet](https://www.physionet.org/content/ptb-xl/1.0.1/) and [kaggle](https://www.kaggle.com/bjoernjostein/ptbxl-electrocardiography-database). A summary of the dataset is provided below.

|**Database**|**Number of patients**|**Number of recordings**|**Number of leads (channels)**|**Duration of each recording (seconds)**|
|---|---|---|---|---|
|PTB-XL|18885|21837|12|10|

### Part 2.2: Dataset properties

This part talks about general properties of the dataset.

1. The ECG recordings were obtained in a hospital or clinical setting over nearly 7 years between October 1989 and June 1996. Devices from Schiller AG were used.

2. Clinicians used a sampling frequency of 500Hz. The data was saved in WaveForm DataBase (WFDB) format with 16-bit precision at at resolution of 1 μV/LSB. The dataset includes a downsampled version of the waveform data at a sampling frequency of 100Hz.

Relevant metadata is stored in 'ptbxl_database.csv', with one row per record identified by ecg_id. The csv file contains 28 columns. These columns can be categorised into:

3. **Identifiers**: Each record is identified by a unique ecg_id. The corresponding patient is encoded via patient_id. The paths to the original record (500 Hz) and a downsampled version of the record (100 Hz) are stored in filename_hr and filename_lr.

4. **General Metadata**: demographic and recording metadata such as age, sex, height, weight, nurse, site, device and recording_date

5. **ECG statements**: core components are scp_codes (SCP-ECG statements as a dictionary with entries of the form statement: likelihood, where likelihood is set to 0 if unknown) and report (report string). Additional fields are heart_axis, infarction_stadium1, infarction_stadium2, validated_by, second_opinion, initial_autogenerated_report and validated_by_human.

6. **Signal Metadata**: signal quality such as noise (static_noise and burst_noise), baseline drifts (baseline_drift) and other artifacts such as electrodes_problems. The database engineers also provide extra_beats for counting extra systoles and pacemaker for signal patterns indicating an active pacemaker.

7. **Cross-validation Folds**: recommended 10-fold train-test splits (strat_fold) obtained via stratified sampling while respecting patient assignments, i.e. all records of a particular patient were assigned to the same fold. Records in fold 9 and 10 underwent at least one human evaluation and are therefore of a particularly high label quality. The data engineers proposed to use folds 1-8 as training set, fold 9 as validation set and fold 10 as test set.

Points 3-7 were taken directly from the physionet page's description with slight modification.


## References

"A cascaded classifier for multi-lead ECG based on feature fusion", [https://doi.org/10.1016/j.cmpb.2019.06.021](https://doi.org/10.1016/j.cmpb.2019.06.021)

1. C.  Ye,  M.  T.  Coimbra,  and  B.  V.  Kumar,  “Arrhythmia  detection  and  classificationusing   morphological   and   dynamic   features   of   ECG   signals”,   in _2010 Annual International  Conference  of  the  IEEE  Engineering  in  Medicine  and  Biology_,  IEEE,2010, pp. 1918–1921.

2. A.  H.  Ribeiro,  M.  H.  Ribeiro,  G.  M.  Paixao,  D.  M.  Oliveira,  P.  R.  Gomes,  J.  A.Canazart,  M.  P.  Ferreira,  C.  R.  Andersson,  P.  W.  Macfarlane,  M.  Wagner  Jr,etal., “Automatic diagnosis of the 12-lead ECG using a deep neural network”, _NatureCommunications_, vol. 11, no. 1, pp. 1–9, 2020.

3. T.-M.  Chen,  C.-H.  Huang,  E.  S.  Shih,  Y.-F.  Hu,  and  M.-J.  Hwang,  “Detection  andclassification of cardiac arrhythmias by a challenge-best deep learning neural networkmodel”, _Iscience_, vol. 23, no. 3, p. 100 886, 2020.